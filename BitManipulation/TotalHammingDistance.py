"""
https://leetcode.com/problems/total-hamming-distance/

The Hamming distance between two integers is the number of positions at which the corresponding bits are different.

Given an integer array nums, return the sum of Hamming distances between all the pairs of the integers in nums.



Example 1:

Input: nums = [4,14,2]
Output: 6
Explanation: In binary representation, the 4 is 0100, 14 is 1110, and 2 is 0010 (just
showing the four bits relevant in this case).
The answer will be:
HammingDistance(4, 14) + HammingDistance(4, 2) + HammingDistance(14, 2) = 2 + 2 + 2 = 6.
Example 2:

Input: nums = [4,14,4]
Output: 4


Constraints:

1 <= nums.length <= 104
0 <= nums[i] <= 109
The answer for the given input will fit in a 32-bit integer.
"""
from typing import List

from Common.ObjectTestingUtils import run_functional_tests


# TLE
# class Solution:
#     def totalHammingDistance(self, nums: List[int]) -> int:
#
#         def distance(a: int, b: int) -> int:
#             res = 0
#             while a or b:
#                 if a & 1 != b & 1:
#                     res += 1
#                 a >>= 1
#                 b >>= 1
#             return res
#
#         result = 0
#         n = len(nums)
#         for i in range(n):
#             for j in range(i+1, n):
#                 result += distance(nums[i], nums[j])
#         return result

# Runtime: 582 ms, faster than 68.04% of Python3 online submissions for Total Hamming Distance.
# Memory Usage: 15.5 MB, less than 70.22% of Python3 online submissions for Total Hamming Distance.
class Solution:
    def totalHammingDistance(self, nums: List[int]) -> int:
        result = 0
        n = len(nums)
        mx = max(nums)
        mask = 1
        while mask < mx:
            mask <<= 1
        while mask:
            n1 = 0
            for i in range(n):
                if nums[i] & mask:
                    n1 += 1
            result += n1 * (n - n1)
            mask >>= 1

        return result


tests = [
    [[3141081,2921903,4087886,3838854,4363880,4861006,8261991,2527304,6330345,8875778,6006203,5807190,816659,3404308,8332778,2335057,4444930,365312,1962044,2722070,2659924,4584726,6631459,700369,4280615,3123553,5903098,8114235,5379350,6285186,4697933,2900615,712647,8910694,3922169,2696815,8687074,3070922,3287882,4372265,4444746,5149266,4581537,7627401,25678,868456,8596398,6776792,3414475,1207746,2960466,4200447,3495556,1385045,7292865,5866487,4747159,7082131,7456754,1125017,4915674,4866844,6808767,2284366,2650850,735053,8083602,9401319,5814178,1865330,2149984,5086934,9044725,6074763,46863,4984729,4740072,45786,4197680,1832522,5281216,8461808,6574288,8010461,4242289,5741940,175242,8282603,3028499,8163211,7266671,1197773,3527344,9967494,4956436,7920864,4435558,9123394,3466909,4373539,5473552,758044,6400894,7322929,2450892,7817262,4832367,6835674,1868603,8411606,1837164,6979578,2078018,8488752,4319960,7568813,9184739,33701,4718907,1686167,2063181,7338849,5071774,4543273,1396954,6622627,7681459,867103,1567461,1339418,7967721,3134555,4020024,6994955,9129856,549500,8918000,5461800,1852779,9084017,5370405,5381971,473423,5147775,379568,2905591,4162991,8159255,2458000,531928,5325642,8547409,7754181,8356714,7787275,6733080,1818361,132756,495935,1079002,1316083,2909178,4967854,4191169,4263254,8144893,9960645,9066938,5468185,4358254,9175624,5144096,6560147,1687877,633594,6451813,5500073,5197734,4510835,3142266,6869311,1371617,3776225,4490633,6813564,967523,1673197,4608524,9290355,5119565,4618475,6627456,612927,4552277,8923803,9145244,3113837,4118798,8567370,9467796,5825473,6021928,448110,3469117,7147883,271482,3067658,5009767,2268513,7294481,677555,4783938,6704581,3874224,9085423,7444337,6630920,3641843,7556251,6621606,9910466,8259553,255329,2090610,1114606,321309,8251647,8371297,6350269,7325822,8171630,1146315,6932492,4474528,1543364,7684094,1182860,8990530,5128754,1945932,8507619,3404097,541633,9689888,4933845,434150,5209575,8408655,7994839,6265069,2516203,9878949,2707558,4558318,4439557,9891744,3645345,5162054,1753874,7431195,6364372,1332167,8391031,2613072,3588253,5616810,7026936,6511412,2338531,4391406,9521154,9146866,4968256,4718495,9083216,9953997,4174136,7471469,8486468,1643706,679554,5007510,4932181,2253547,6966784,2850838,9517143,4115500,6604397,1670913,7778046,5392189,1812306,7588016,7608027,4971460,5101610,4010457,2749852,1896844,4050203,4180941,4529014,6950452,6802204,4147781,6126140,7875614,1660408,3725133,1758524,3111590,2368802,4575723,5180948,9474889,181610,5140022,1859341,7677751,410104,6779387,832019,6536605,1558860,6919501,7036257,5337215,9330354,9076558,9793237,3093886,8632784,9705695,8998938,1936941,4373106,8059031,862678,6813174,5755748,1605033,1176399,5460,2012442,5009965,5201256,1186488,349638,6238259,1355933,1901504,5667779,9294940,1752150,1785350,814058,7184679,3160477,9735276,9768160,68037,888614,8767326,4889062,5644959,6446911,1815650,6646091,1520505,288817,3455112,9521427,2956822,9061716,1472943,8792973,4990279,4034255,7348770,8881889,2178045,7182117,5856075,226631,892524,4968383,1051406,1831644,5152850,3811736,4302588,6712830,5324188,5362342,8830822,3499933,7149507,6086005,8045493,4614290,3557805,3663519,4304471,574613,4716657,2527462,4299494,6970372,5796066,9566525,8795350,788542,4001755,7015740,6342041,2457893,2504491,4164565,2673451,6819148,3384212,3952927,8089811,9083604,1375225,7090060,6655877,5306096,2284456,3982192,418374,503832,3376371,6153907,2569115,7275109,2938574,9163516,2028252,8300678,111980,7589237,3489463,8324750,3210039,263386,4312276,3219314,9905244,1882800,6195784,6960454,7240883,7307149,1037563,2729500,8574490,9042992,4520275,3921656,4381471,4711365,1338149,4395217,7998787,8725082,6420645,2958254,7114007,6370531,3196878,1143571,1515774,2559344,7421891,9123045,8976688,5950525,1767290,7586285,2272043,6272346,2866741,8615775,9330363,5854200,5507194,3233027,1204436,1007316,6840326,1060856,3097482,2932312,2756415,8216518,3455373,915497,387883,28063,4329020,6970787,3198481,1888571,1755382,5020572,1091594,7970802,7298433,395775,884463,1427178,3300886,2793403,865944,608103,9230441,528726,5357205,3485373,7676565,8139689,8693638,2704359,3097571,4077290,7705883,629362,4148943,9075941,2492540,2388663,8347083,6269903,2418286,9503821,2977469,1786779,3839151,6804491,7394858,5727326,9399679,4909544,2390555,8837,8816127,5482512,6890141,3155227,7176993,4850874,3561290,2528582,741823,658879,1767653,4588692,9256908,9511571,1031496,3921297,3921602,4633312,8070027,5049673,4083876,1466007,4645330,8848440,6322682,297492,2552793,1394545,4838055,7805710,5317814,1961238,3204493,6747365,911998,1015590,7718355,6182686,8165323,4366211,4725834,9925167,7630127,3627358,4808546,7558881,6198084,8165374,5314012,8962490,1815829,953301,9990600,8840355,9964131,9519497,8091355,7370925,6385060,8391870,2606367,4408029,5925337,8511487,3694749,4728458,1522113,4368362,2220646,2442967,9431255,7728686,9634515,3884791,7723548,6012505,1555347,6150243,2196380,9704193,8654936,60358,1567460,7170635,1658257,1557943,2636682,536365,1027501,6043175,583194,3577435,7660240,8316929,1976247,360868,9225737,4965330,1205701,7414505,5855542,6031522,4944978,278837,135677,2216915,1980471,5078102,8393347,1921396,1842001,1908859,9497019,6411834,9193310,2302054,6466553,821275,3504021,7199478,2314780,6978814,1618981,4257480,6156965,2654433,7092978,2799038,3756478,8650604,8381634,2249736,670886,2653857,1306169,2694956,8390773,7057022,1251369,2970113,4397554,392414,8029958,1609990,9635032,587542,1677494,9028426,4900045,4311551,5887905,6185551,4623578,5462799,629440,8361802,3605690,5488136,2146866,7173798,315977,711587,7935408,7136320,9475319,5728799,490101,2339253,1333280,3814245,6257596,9161913,2582009,3069122,9615215,9172825,2604124,9182083,3012798,1239749,1826997,4025697,2094844,5007800,6172389,3974444,4319495,57957,3428055,5889649,2992337,1245745,8617102,1238209,6722572,3560803,9548084,9682264,6583522,6886567,1562766,8536530,7201695,7331478,3050734,35966,923405,9099217,5690471,9245785,2386022,4127105,14009,5572374,8848129,2134261,2205895,5561466,189751,272009,8718635,8065916,1160607,2421560,3751584,9252613,5982551,1968294,3871797,7042523,4069944,6091039,8834573,144345,1547792,7038069,5350010,7445141,5257615,5524267,2086493,363477,3897753,6842172,3034490,5861391,2688311,2890900,9035798,4739917,1776213,501257,5502633,6406743,2039696,7830965,6267888,7422981,9777740,3551252,8290270,4406369,8072163,5329135,7210062,200068,7777606,3266554,2311214,4786652,1663535,5762468,6488095,1871580,6842889,8291421,2180537,5858849,1995583,3296375,7541626,6711453,5217704,4254403,7037092,6548060,6023067,5606616,2964022,5355540,1043095,7048779,7169891,22848,5992804,2991708,9635586,463220,550286,6340703,5039796,1670761,323270,2125619,8472313,9237800,1218882,9863017,2387366,3862494,5833336,6923058,2011536,9341334,7251240,5880069,1326033,3479982,1619295,8619433,9636971,6810137,4578047,8743237,8819374,6116620,3019308,4410252,1897897,372552,9200080,70111,723109,7250150,8935861,2140916,6911947,2153291,5814017,6901003,7743527,2150403,558378,862902,3860919,1880912,3211857,6406335,1762373,8670732,8015885,977301,2457134,8741889,3995782,3939371,909363,2226324,5400958,2215665,453567,6223472,6204445,5167593,2635893,988377,7435820,1364391,7779576,4131923,6473335,593948,381692,1640414,1456887,2541136,4515703,7767763,4552276,3579374,3274037,1237861,6415113,8165019,5012015,1686272,328936,9735592,8926749,519775,4750439,9216534,6656687,2462944,7824158,6716305,8672823,9616144,7381794,5946923,1305141,2654785,718175,4245499,6102786,1991315,5379209,6512913,2925927,6435830,3116859,1717219,1967677,1211011,7879519,4008766,1766416,3324477,6218118,4876812,5042633,3076686,5827918,8808843,1854459,5061377,6854783,1476856,9579739,3018337,9751988,432989,9026071,2633650,5288475,3533043,7871897,4516411,3607588,9711156,2429319,874120,5210866,8549782,6844858,8268736,5553653,7580151,2507328,5389202,4892774,3787675,2641717], 5846235],
    [[4,14,2], 6],
    [[4,14,4], 4]
]

run_functional_tests(Solution().totalHammingDistance, tests)
